<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Checklist Interactivo: Autorizaci√≥n Apps Script</title>
  <style>
    :root{
      --bg:#0f1220;
      --card:#171a2f;
      --line:#2a2e52;
      --accent:#7c9cff;
      --ok:#35d49a;
      --bad:#ff6b6b;
      --warn:#ffd93d;
      --txt:#e9ecff;
    }
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:linear-gradient(180deg,#0c0f1d,#12152b);
      color:var(--txt);
      padding:40px 20px;
    }
    .wrap{max-width:800px;margin:0 auto}
    h1{text-align:center;color:var(--bad);margin-bottom:10px}
    .subtitle{text-align:center;opacity:0.8;margin-bottom:40px;font-size:18px}
    
    .error-box{
      background:rgba(255,107,107,0.15);
      border:2px solid var(--bad);
      border-radius:12px;
      padding:20px;
      margin:30px 0;
      text-align:center;
    }
    
    .checklist{
      background:var(--card);
      border:2px solid var(--line);
      border-radius:12px;
      padding:25px;
      margin:30px 0;
    }
    
    .checklist h2{
      margin-top:0;
      color:var(--accent);
      display:flex;
      align-items:center;
      gap:10px;
    }
    
    .item{
      display:flex;
      align-items:flex-start;
      gap:15px;
      padding:15px;
      margin:10px 0;
      background:rgba(255,255,255,0.03);
      border-radius:8px;
      border-left:4px solid var(--line);
      cursor:pointer;
      transition:all 0.3s;
    }
    
    .item:hover{
      background:rgba(255,255,255,0.06);
    }
    
    .item.checked{
      border-left-color:var(--ok);
      background:rgba(53,212,154,0.1);
    }
    
    .checkbox{
      width:30px;
      height:30px;
      min-width:30px;
      border:2px solid var(--line);
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:20px;
      background:rgba(0,0,0,0.3);
      transition:all 0.3s;
    }
    
    .item.checked .checkbox{
      background:var(--ok);
      border-color:var(--ok);
    }
    
    .item-content{
      flex:1;
    }
    
    .item-title{
      font-weight:bold;
      margin-bottom:5px;
      font-size:16px;
    }
    
    .item-desc{
      opacity:0.8;
      font-size:14px;
      line-height:1.5;
    }
    
    .progress-bar{
      background:rgba(0,0,0,0.3);
      height:30px;
      border-radius:15px;
      overflow:hidden;
      margin:20px 0;
    }
    
    .progress-fill{
      height:100%;
      background:linear-gradient(90deg,var(--ok),var(--accent));
      width:0%;
      transition:width 0.5s;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:bold;
      font-size:14px;
    }
    
    .warning{
      background:rgba(255,217,61,0.15);
      border:2px solid var(--warn);
      border-radius:12px;
      padding:20px;
      margin:20px 0;
    }
    
    .success{
      background:rgba(53,212,154,0.15);
      border:2px solid var(--ok);
      border-radius:12px;
      padding:20px;
      margin:20px 0;
      display:none;
    }
    
    .success.show{
      display:block;
    }
    
    .button{
      background:linear-gradient(135deg,var(--accent),#5a74ff);
      border:none;
      padding:15px 30px;
      border-radius:12px;
      color:white;
      font-weight:bold;
      font-size:16px;
      cursor:pointer;
      width:100%;
      margin:10px 0;
      transition:transform 0.2s;
    }
    
    .button:hover{
      transform:scale(1.02);
    }
    
    .button:active{
      transform:scale(0.98);
    }
    
    .links{
      background:rgba(124,156,255,0.1);
      border-radius:12px;
      padding:20px;
      margin:30px 0;
    }
    
    .links a{
      color:var(--accent);
      text-decoration:none;
      display:block;
      padding:10px;
      border-radius:8px;
      margin:5px 0;
      transition:background 0.2s;
    }
    
    .links a:hover{
      background:rgba(124,156,255,0.2);
    }
  </style>
</head>
<body>
<div class="wrap">
  <h1>üö® Checklist: Error de Permisos</h1>
  <div class="subtitle">Marca cada paso que REALMENTE completaste</div>

  <div class="error-box">
    <h3 style="margin-top:0;color:var(--bad)">‚ùå Error Actual:</h3>
    <code style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;display:block">
      ‚õî Error al generar PDF: Exception: No cuentas con el permiso para llamar a DocumentApp.create
    </code>
  </div>

  <div class="progress-bar">
    <div class="progress-fill" id="progressBar">0%</div>
  </div>

  <div class="checklist">
    <h2>üìã Pasos de Autorizaci√≥n</h2>
    <p style="opacity:0.8;margin-bottom:20px">
      Haz click en cada paso que S√ç completaste. Si NO completaste alguno, ah√≠ est√° el problema.
    </p>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">1. Abr√≠ el Editor de Apps Script</div>
        <div class="item-desc">Extensiones ‚Üí Apps Script desde el Spreadsheet</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">2. Verifiqu√© que existe appsscript.json</div>
        <div class="item-desc">El archivo aparece en el panel izquierdo (sin .gs al final)</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">3. Copi√© el contenido correcto a appsscript.json</div>
        <div class="item-desc">Con los oauthScopes incluyendo "documents" y "drive"</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">4. Guard√© el archivo (Ctrl+S)</div>
        <div class="item-desc">Vi que se guard√≥ sin errores</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">5. Seleccion√© la funci√≥n "onOpen" en el dropdown</div>
        <div class="item-desc">Dropdown arriba al centro del editor</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">6. Presion√© el bot√≥n Ejecutar (‚ñ∂Ô∏è)</div>
        <div class="item-desc">El bot√≥n de play a la derecha del dropdown - ESTO ES CR√çTICO</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">7. Vi el di√°logo de autorizaci√≥n</div>
        <div class="item-desc">Popup que dice "Autorizaci√≥n necesaria"</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">8. Hice click en "Revisar permisos"</div>
        <div class="item-desc">En el di√°logo de autorizaci√≥n (NO lo cerr√©)</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">9. Hice click en "Configuraci√≥n avanzada"</div>
        <div class="item-desc">Cuando vi "Esta app no est√° verificada"</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">10. Hice click en "Ir a [proyecto] (no seguro)"</div>
        <div class="item-desc">Enlace que aparece despu√©s de "Configuraci√≥n avanzada"</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">11. Vi la lista de permisos</div>
        <div class="item-desc">Incluyendo "Ver y administrar documentos" y "archivos de Drive"</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">12. Hice click en "Permitir"</div>
        <div class="item-desc">Bot√≥n azul al final de la lista de permisos</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">13. El di√°logo se cerr√≥ autom√°ticamente</div>
        <div class="item-desc">Sin errores, regres√© al editor</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">14. Cerr√© el Editor y volv√≠ al Spreadsheet</div>
        <div class="item-desc">Cerr√© la pesta√±a/ventana del Apps Script</div>
      </div>
    </div>

    <div class="item" onclick="toggleItem(this)">
      <div class="checkbox"></div>
      <div class="item-content">
        <div class="item-title">15. Recargu√© el Spreadsheet (F5)</div>
        <div class="item-desc">Presion√© F5 o el bot√≥n de recargar del navegador</div>
      </div>
    </div>
  </div>

  <div class="warning">
    <strong>‚ö†Ô∏è Si NO marcaste TODOS los pasos:</strong><br>
    Ese es el problema. Debes completar TODOS los pasos en orden para que la autorizaci√≥n funcione.
  </div>

  <div class="success" id="successBox">
    <strong style="color:var(--ok)">‚úÖ Si marcaste todos los pasos y A√öN tienes el error:</strong><br>
    El problema puede ser m√°s complejo. Consulta la gu√≠a detallada de troubleshooting o revoca los permisos y vuelve a intentar.
  </div>

  <button class="button" onclick="window.location.reload()">üîÑ Reiniciar Checklist</button>

  <div class="links">
    <h3 style="margin-top:0">üìö Recursos de Ayuda</h3>
    <a href="AYUDA_ERROR_PERSISTE.md" target="_blank">üìñ Gu√≠a Completa de Troubleshooting</a>
    <a href="https://myaccount.google.com/permissions" target="_blank">üîê Revocar Permisos (Google Account)</a>
    <a href="GUIA_RAPIDA_PERMISOS.md" target="_blank">‚ö° Gu√≠a R√°pida Original</a>
    <a href="SOLUCION_PERMISOS_DOCUMENTAPP.md" target="_blank">üìò Documentaci√≥n Completa</a>
  </div>

  <div style="text-align:center;margin-top:40px;opacity:0.6">
    <p>Si completaste TODOS los pasos y el error persiste, necesitas ayuda adicional.</p>
    <p>Guarda una captura de pantalla de este checklist completado para referencia.</p>
  </div>
</div>

<script>
function toggleItem(item) {
  item.classList.toggle('checked');
  updateProgress();
}

function updateProgress() {
  const items = document.querySelectorAll('.item');
  const checked = document.querySelectorAll('.item.checked');
  const percentage = Math.round((checked.length / items.length) * 100);
  
  const progressBar = document.getElementById('progressBar');
  progressBar.style.width = percentage + '%';
  progressBar.textContent = percentage + '%';
  
  // Actualizar checkboxes
  items.forEach(item => {
    const checkbox = item.querySelector('.checkbox');
    if (item.classList.contains('checked')) {
      checkbox.textContent = '‚úì';
    } else {
      checkbox.textContent = '';
    }
  });
  
  // Mostrar mensaje de √©xito si complet√≥ todos
  const successBox = document.getElementById('successBox');
  if (percentage === 100) {
    successBox.classList.add('show');
  } else {
    successBox.classList.remove('show');
  }
}

// Inicializar
updateProgress();
</script>
</body>
</html>
