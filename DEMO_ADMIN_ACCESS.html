<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Demo - Control de Acceso Administrador</title>
  <style>
    :root{
      --bg:#0f1220;
      --card:#171a2f;
      --line:#2a2e52;
      --accent:#7c9cff;
      --ok:#35d49a;
      --bad:#ff6b6b;
      --txt:#e9ecff;
    }
    body{
      margin:0;
      padding:20px;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;
      background:linear-gradient(180deg,#0c0f1d,#12152b);
      color:var(--txt);
      line-height:1.6;
    }
    .container{
      max-width:600px;
      margin:0 auto;
    }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:16px;
      padding:16px;
      margin-bottom:14px;
    }
    .card.highlight{
      border:2px solid var(--accent);
      background:rgba(124,156,255,.05);
    }
    .card.success{
      border:2px solid var(--ok);
      background:rgba(53,212,154,.05);
    }
    .card.error{
      border:2px solid var(--bad);
      background:rgba(255,107,107,.05);
    }
    h1{
      margin:0 0 20px 0;
      font-size:28px;
    }
    h2{
      margin:20px 0 10px 0;
      font-size:22px;
    }
    h3{
      margin:15px 0 8px 0;
      font-size:18px;
    }
    .small{
      opacity:.85;
      font-size:14px;
    }
    button{
      width:100%;
      padding:12px;
      border-radius:12px;
      border:1px solid var(--line);
      background:#0c0f1d;
      color:var(--txt);
      font-size:16px;
      box-sizing:border-box;
      margin-top:8px;
      font-weight:700;
      cursor:pointer;
    }
    button:disabled{
      opacity:0.3;
      cursor:not-allowed;
    }
    .comparison{
      display:flex;
      gap:14px;
      margin:20px 0;
    }
    .comparison > div{
      flex:1;
    }
    .badge{
      background:#7c9cff;
      color:#fff;
      padding:4px 8px;
      border-radius:6px;
      font-size:12px;
      font-weight:900;
      display:inline-block;
      margin-bottom:6px;
    }
    .badge.success{
      background:var(--ok);
    }
    .badge.error{
      background:var(--bad);
    }
    code{
      background:#0c0f1d;
      padding:2px 6px;
      border-radius:4px;
      font-size:13px;
      color:var(--accent);
    }
    ul{
      margin:8px 0;
      padding-left:24px;
    }
    li{
      margin:6px 0;
    }
    .step{
      background:rgba(255,255,255,.03);
      padding:10px 14px;
      border-left:3px solid var(--accent);
      margin:10px 0;
      border-radius:0 8px 8px 0;
    }
    table{
      width:100%;
      border-collapse:collapse;
      margin:10px 0;
      font-size:13px;
    }
    th,td{
      padding:8px;
      text-align:left;
      border:1px solid var(--line);
    }
    th{
      background:rgba(124,156,255,.1);
      font-weight:700;
    }
    @media (max-width: 650px) {
      .comparison{
        flex-direction:column;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ” Control de Acceso: Administrador</h1>
    
    <div class="card">
      <h2>ğŸ“‹ Resumen del Cambio</h2>
      <p class="small">
        Se implementÃ³ un sistema de control de acceso para restringir la gestiÃ³n del dÃ©cimo partido 
        solo a usuarios administradores autorizados.
      </p>
      <ul class="small">
        <li><strong>Antes:</strong> Cualquier usuario podÃ­a modificar el dÃ©cimo partido</li>
        <li><strong>Ahora:</strong> Solo 2 personas especÃ­ficas (admins) pueden hacerlo</li>
        <li><strong>BotÃ³n:</strong> Cambiado de "ğŸŒ Gestionar dÃ©cimo partido" a "ğŸ‘¤ Administrador"</li>
      </ul>
    </div>

    <h2 style="margin-top:30px">ğŸ¨ ComparaciÃ³n Visual</h2>

    <div class="comparison">
      <div>
        <div class="card error">
          <div class="badge error">ANTES</div>
          <h3 style="margin-top:8px">Usuario Regular</h3>
          <button>ğŸ“Š Ver tabla / transparencia</button>
          <button>ğŸŒ Gestionar dÃ©cimo partido</button>
          <div class="small" style="margin-top:10px;color:var(--bad)">
            âŒ BotÃ³n visible para todos<br>
            âŒ Sin control de acceso<br>
            âŒ Cualquiera podÃ­a modificar
          </div>
        </div>
      </div>

      <div>
        <div class="card success">
          <div class="badge success">AHORA</div>
          <h3 style="margin-top:8px">Usuario Regular</h3>
          <button>ğŸ“Š Ver tabla / transparencia</button>
          <button disabled>ğŸ‘¤ Administrador</button>
          <div class="small" style="margin-top:10px;color:var(--ok)">
            âœ… BotÃ³n oculto automÃ¡ticamente<br>
            âœ… Sin acceso a funciones admin<br>
            âœ… Solo ve sus picks
          </div>
        </div>
      </div>
    </div>

    <div class="comparison">
      <div>
        <div class="card highlight">
          <div class="badge">ADMINISTRADOR</div>
          <h3 style="margin-top:8px">Vista Admin</h3>
          <button>ğŸ“Š Ver tabla / transparencia</button>
          <button style="border:2px solid var(--accent)">ğŸ‘¤ Administrador</button>
          <div class="small" style="margin-top:10px;color:var(--ok)">
            âœ… BotÃ³n visible y funcional<br>
            âœ… Acceso completo<br>
            âœ… Puede gestionar 10Â° partido
          </div>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>âš™ï¸ ConfiguraciÃ³n en Google Sheets</h2>
      <p class="small">En la hoja <strong>CONFIG</strong>, agregar:</p>
      
      <table>
        <thead>
          <tr>
            <th>KEY</th>
            <th>VALUE</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>AdminPlayers</code></td>
            <td><code>Juan PÃ©rez,MarÃ­a GarcÃ­a</code></td>
          </tr>
        </tbody>
      </table>

      <div class="small" style="margin-top:10px;padding:10px;background:rgba(124,156,255,.1);border-radius:8px">
        <strong>Importante:</strong>
        <ul style="margin:5px 0">
          <li>Los nombres deben coincidir con los de la hoja JUGADORES</li>
          <li>Separar con comas (sin espacios extra)</li>
          <li>No distingue mayÃºsculas/minÃºsculas</li>
          <li>Solo 2 personas recomendadas</li>
        </ul>
      </div>
    </div>

    <div class="card">
      <h2>ğŸ”’ Sistema de ValidaciÃ³n</h2>
      
      <h3>1. Frontend (Index.html)</h3>
      <div class="step">
        <strong>Al cargar la pÃ¡gina:</strong>
        <ul class="small" style="margin:5px 0">
          <li>Llama <code>api_isPlayerAdmin(token)</code></li>
          <li>Si es admin: muestra botÃ³n "ğŸ‘¤ Administrador"</li>
          <li>Si NO es admin: oculta el botÃ³n</li>
        </ul>
      </div>

      <div class="step">
        <strong>Al hacer clic:</strong>
        <ul class="small" style="margin:5px 0">
          <li>Verifica <code>SESSION.isAdmin</code></li>
          <li>Si NO es admin: muestra alerta y cancela</li>
          <li>Si es admin: abre panel de gestiÃ³n</li>
        </ul>
      </div>

      <h3 style="margin-top:16px">2. Backend (Code.gs)</h3>
      <div class="step">
        <strong>Al guardar/eliminar:</strong>
        <ul class="small" style="margin:5px 0">
          <li>Valida token con <code>findJugadorByToken_()</code></li>
          <li>Obtiene nombre del jugador</li>
          <li>Verifica con <code>isPlayerAdminByName_()</code></li>
          <li>Si NO es admin: retorna error</li>
          <li>Si es admin: procesa la operaciÃ³n</li>
        </ul>
      </div>
    </div>

    <div class="card">
      <h2>ğŸ’¬ Mensajes de Error</h2>
      
      <div style="padding:12px;background:rgba(255,107,107,.1);border:2px solid var(--bad);border-radius:10px;margin:10px 0">
        <strong style="color:var(--bad)">Para usuarios NO administradores:</strong>
        <div class="small" style="margin-top:8px">
          "â›” Solo los administradores pueden acceder a esta funciÃ³n."
        </div>
      </div>

      <div style="padding:12px;background:rgba(255,107,107,.1);border:2px solid var(--bad);border-radius:10px;margin:10px 0">
        <strong style="color:var(--bad)">Al intentar guardar sin permisos:</strong>
        <div class="small" style="margin-top:8px">
          "Solo los administradores pueden configurar el dÃ©cimo partido."
        </div>
      </div>

      <div style="padding:12px;background:rgba(255,107,107,.1);border:2px solid var(--bad);border-radius:10px;margin:10px 0">
        <strong style="color:var(--bad)">Al intentar eliminar sin permisos:</strong>
        <div class="small" style="margin-top:8px">
          "Solo los administradores pueden eliminar el dÃ©cimo partido."
        </div>
      </div>
    </div>

    <div class="card">
      <h2>ğŸ”„ Flujo de AutorizaciÃ³n</h2>
      
      <div class="step">
        <strong>1. Login</strong><br>
        <span class="small">Usuario inicia sesiÃ³n con su token</span>
      </div>
      
      <div class="step">
        <strong>2. ValidaciÃ³n</strong><br>
        <span class="small">Sistema valida token con <code>api_loginByToken()</code></span>
      </div>
      
      <div class="step">
        <strong>3. Check Admin</strong><br>
        <span class="small">Sistema verifica con <code>api_isPlayerAdmin()</code></span>
      </div>
      
      <div class="step">
        <strong>4a. Si es Admin</strong><br>
        <span class="small" style="color:var(--ok)">âœ… Muestra botÃ³n "ğŸ‘¤ Administrador"</span><br>
        <span class="small" style="color:var(--ok)">âœ… Permite gestionar dÃ©cimo partido</span>
      </div>
      
      <div class="step">
        <strong>4b. Si NO es Admin</strong><br>
        <span class="small" style="color:var(--bad)">âŒ Oculta botÃ³n</span><br>
        <span class="small" style="color:var(--bad)">âŒ Bloquea acceso</span><br>
        <span class="small" style="color:var(--bad)">âŒ Muestra error si intenta acceder</span>
      </div>
    </div>

    <div class="card highlight">
      <h2>âœ… CaracterÃ­sticas de Seguridad</h2>
      <ul>
        <li><strong>Token-based:</strong> Todas las operaciones requieren token vÃ¡lido</li>
        <li><strong>Server-side:</strong> Validaciones crÃ­ticas en el backend (Code.gs)</li>
        <li><strong>Name-based:</strong> Usa nombres de jugadores de JUGADORES</li>
        <li><strong>Multi-capa:</strong> Frontend oculta UI + Backend valida permisos</li>
        <li><strong>Clear feedback:</strong> Mensajes de error descriptivos</li>
        <li><strong>Easy config:</strong> Un solo campo en CONFIG sheet</li>
      </ul>
    </div>

    <div class="card">
      <h2>ğŸ“Š Cambios TÃ©cnicos</h2>
      
      <h3>Code.gs</h3>
      <ul class="small">
        <li>â• <code>api_isPlayerAdmin(token)</code> - Endpoint para verificar admin</li>
        <li>â• <code>isPlayerAdminByName_(playerName)</code> - Helper de validaciÃ³n</li>
        <li>ğŸ”„ <code>api_guardarDecimoPartido()</code> - Ahora valida admin + token</li>
        <li>ğŸ”„ <code>api_quitarDecimoPartido()</code> - Ahora valida admin + token</li>
      </ul>

      <h3 style="margin-top:12px">Index.html</h3>
      <ul class="small">
        <li>ğŸ”„ SESSION object - Agregado campo <code>isAdmin</code></li>
        <li>ğŸ”„ BotÃ³n - Texto cambiado a "ğŸ‘¤ Administrador"</li>
        <li>ğŸ”„ BotÃ³n - ID agregado: <code>adminButton</code></li>
        <li>ğŸ”„ BotÃ³n - Oculto por defecto (<code>display:none</code>)</li>
        <li>â• Admin check en bootstrap - Muestra/oculta botÃ³n</li>
        <li>â• Guard en <code>openDecimoPartido()</code> - Previene acceso</li>
        <li>ğŸ”„ Funciones save/delete - Pasan token en payload</li>
      </ul>
    </div>

    <div class="card success">
      <h2>ğŸ¯ Resultado Final</h2>
      <p><strong>Requisito 1: âœ… Completado</strong></p>
      <p class="small">Solo 2 personas especÃ­ficas pueden modificar el dÃ©cimo partido (configurables en CONFIG)</p>
      
      <p style="margin-top:12px"><strong>Requisito 2: âœ… Completado</strong></p>
      <p class="small">BotÃ³n cambiado de "Gestionar dÃ©cimo partido" a "Administrador"</p>

      <p style="margin-top:12px"><strong>Seguridad: âœ… Implementada</strong></p>
      <p class="small">Sistema de validaciÃ³n en mÃºltiples capas (frontend + backend)</p>

      <p style="margin-top:12px"><strong>Experiencia: âœ… Mejorada</strong></p>
      <p class="small">Usuarios regulares no ven opciones que no pueden usar</p>
    </div>

    <div style="margin-top:30px;padding:20px;background:rgba(124,156,255,.15);border-radius:12px;text-align:center">
      <h2 style="margin-top:0;color:var(--accent)">ğŸ” Sistema de AdministraciÃ³n Implementado</h2>
      <p class="small">
        Control de acceso robusto y fÃ¡cil de configurar para la gestiÃ³n del dÃ©cimo partido
      </p>
    </div>
  </div>
</body>
</html>
